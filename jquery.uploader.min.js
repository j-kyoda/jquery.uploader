(function(c){c.fn.uploder=function(g){function h(e){e=e[0].files;var a="",a=a+"<table>",a=a+"<tr>",a=a+"<th>No</th>",a=a+"<th>name</th>",a=a+"<th>size</th>",a=a+"<th>type</th>",a=a+"<th>lastModifiedDate</th>",a=a+"</tr>";c.each(e,function(b,c){a+="<tr>";a+='<td style="text-align: right">';a+=b+"</td>";a+="<td>"+c.name+"</td>";a+='<td style="text-align: right">';a+=c.size+"</td>";a+="<td>"+c.type+"</td>";a+="<td>"+c.lastModifiedDate+"</td>";a+="</tr>"});a+="</table>";c(b.sel_dialog+" div.detail-info").html(a);
c(b.sel_dialog+" span.link a").click(function(a){a.preventDefault();c(b.sel_dialog+" div.detail-info").toggle()})}function l(e){c(b.sel_dialog).show();e=Math.floor((c(window).width()-c(b.sel_dialog).width())/2);var a=Math.floor((c(window).height()-c(b.sel_dialog).height())/2);c(b.sel_dialog).css({top:a,left:e,opacity:0}).animate({opacity:0.8},{queue:!0,duration:500,easing:"linear",complete:function(){}})}function m(e,a){var d=a.upload,f=c(b.sel_dialog+" span.progress"),g=c(b.sel_dialog+" span.status");
f.text(b.progress.init);d.onprogress=function(a){f.text(b.progress.loadstart);g.text(a.loaded+" / "+a.total+" ("+Math.floor(100*(a.loaded/a.total))+"%)")};d.onloadstart=function(a){f.text(b.progress.loadstart);b.fn_loadstart(a)};d.ontimeout=function(a){f.text(b.progress.timeout);b.fn_timeout(a)};d.onabort=function(a){f.text(b.progress.abort);b.fn_abort(a)};d.onerror=function(a){f.text(b.progress.error);b.fn_error(a)};d.onload=function(a){f.text(b.progress.load);c(b.sel_dialog).fadeOut(500);b.fn_load(a)};
var d=c(b.sel_form)[0],k=new FormData(d),h=e.attr("name");k.append("field_name",h);a.open(d.method,d.action);a.send(k)}var b=c.extend({sel_form:"form",sel_dialog:"#transfer-info",fn_loadstart:function(){},fn_timeout:function(){},fn_abort:function(){},fn_error:function(){},fn_load:function(){},progress:{init:"initializing...",progress:"sending...",loadstart:"starting...",timeout:"timeout...",abort:"abort.",error:"error T_T",load:"finish."}},g),n=function(){return this.each(function(e){var a=c(this);
a.change(function(d){a.val()&&(window.FormData?(d=new XMLHttpRequest,d.upload?(window.File&&h(a),l(a),m(a,d)):c(b.sel_form).submit()):c(b.sel_form).submit())})})};return"set_val"==g?function(){return this.each(function(b){c(this);return!0})}.apply(this):n.apply(this)}})(jQuery);
